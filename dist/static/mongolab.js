angular.module("mongolabResource",[]).factory("mongolabResource",["MONGOLAB_CONFIG","$http","$q",function(t,e,n){function r(r){var i=t.baseUrl+t.dbName+"/collections/"+r,o={};t.apiKey&&(o.apiKey=t.apiKey);var s=function(t,e,i,o){var s=e||angular.noop,u=i||angular.noop;return t.then(function(t){var e;if(o){e=[];for(var i=0;t.data.length>i;i++)e.push(new a(t.data[i]))}else{if(" null "===t.data)return n.reject({code:"resource.notfound",collection:r});e=new a(t.data)}return s(e,t.status,t.headers,t.config),e},function(t){return u(void 0,t.status,t.headers,t.config),void 0})},a=function(t){angular.extend(this,t)};return a.all=function(t,e){return a.query({},t,e)},a.query=function(t,n,r){var a=angular.isObject(t)?{q:JSON.stringify(t)}:{},u=e.get(i,{params:angular.extend({},o,a)});return s(u,n,r,!0)},a.getById=function(t,n,r){var a=e.get(i+"/"+t,{params:o});return s(a,n,r)},a.getByIds=function(t,e,n){var r=[];return angular.forEach(t,function(t){r.push({$oid:t})}),a.query({_id:{$in:r}},e,n)},a.prototype.$id=function(){return this._id&&this._id.$oid?this._id.$oid:void 0},a.prototype.$save=function(t,n){var r=e.post(i,this,{params:o});return s(r,t,n)},a.prototype.$update=function(t,n){var r=e.put(i+"/"+this.$id(),angular.extend({},this,{_id:void 0}),{params:o});return s(r,t,n)},a.prototype.$remove=function(t,n){var r=e["delete"](i+"/"+this.$id(),{params:o});return s(r,t,n)},a.prototype.$saveOrUpdate=function(t,e,n,r){return this.$id()?this.$update(e,r):this.$save(t,n)},a}return r}]);